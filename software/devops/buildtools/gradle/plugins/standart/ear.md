# ear plugin

## ear.gradle

```groovy
apply plugin: 'ear'

dependencies {
  //INFO: creates ear/*.war
  //INFO: without configuration part, the jar package will be used
  deploy project(path: ':web-war', configuration: 'archives')
  //INFO: creates ear/*.jar
  deploy project(path: ':ejb-jar', configuration: 'archives')
  //INFO: creates ear/lib/*persistence.jar, it also puts the project deps in same lib directory
  earlib project(':persistence.jar')
}

ear {
  //INFO: there is not src/main/application/META-INF/application.xml
  //INFO: so it will be generated by the definition here
  deploymentDescriptor {
    //INFO: is used in application.xml, and in logs looks better than generated name
    applicationName 'jee6resttemplate'

    initializeInOrder = true
  }
}
```

- if the project already has META-INF/application.xml, it will be used and
  *ear.deploymentDescriptor* will be ignored

* ear plugin has two *configurations* which are used to control what is put where into the ear

## deploy configuration

- all deps will be placed into the ear root
- deploy is not transtive
- if we use *deploy project(':ejb')*
  - ejb.jar will be placed into the root of the ear
  - and it will ignore all deps of project(':ejb')

```shell
app.ear
\-- ejb.jar
```

## earlib configuration

- all deps will be placed into the lib folder of the ear
- earlib is transitive

```shell
app.ear
|-- lib
    |-- ejb.jar
    \-- dep.jar
```


### examples

- lets create the following structure

```shell
app.ear
|-- ejb.jar
\-- lib
    |-- dep.jar
    |-- ...
```

```groovy
dependencies {
  deploy project(':ejb')  // ejb.jar at the root level
  earlib project(':ejb')  // bring ejb.jar deps in lib
}
```

- result

```shell
app.ear
|-- ejb.jar
\-- lib
    |-- ejb.jar // !! earlib also bring ejb.jar here
    |-- dep.jar
    |-- ...
```

- select *compile* configuration

```groovy
dependencies {
  deploy project(':ejb')  // ejb.jar at the root level
  earlib project(path: ':ejb', configuration: 'compile')  // it will just bring compile dependencies of ejb.jar
}
```

```shell
app.ear
|-- ejb.jar
\-- lib
    |-- dep.jar
    |-- ...
```
